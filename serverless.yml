service: svc-sls-process-de-para-account-ecd

frameworkVersion: '3'
useDotenv: true

provider:
  name: aws
  runtime: python3.9
  stage: prod
  region: us-east-2
  memorySize: 128
  environment:
    AWS_S3_ACCESS_KEY_ID: ${file(./env.json):AWS_S3_ACCESS_KEY_ID}
    AWS_S3_SECRET_ACCESS_KEY: ${file(./env.json):AWS_S3_SECRET_ACCESS_KEY}
    AWS_S3_REGION: ${file(./env.json):AWS_S3_REGION}

plugins:
- serverless-python-requirements

custom:
  pythonRequirements:
    dockerizeZip: true
    layer:
      name: py-smart_open_6_3_0
      description: "Layer which contains smart_open==6.3.0 library to python"
      compatibleRuntimes:
        - python3.9

functions:
  processDeParaAccountECD:
    handler: src/handler.main
    layers:
      - Ref: PythonRequirementsLambdaLayer
    events:
      - s3:
          bucket: autmais-ecd-de-para-accounting-plan
          event: s3:ObjectCreated:*
          existing: true
          forceDeploy: true